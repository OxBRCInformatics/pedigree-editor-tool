/*! pedigree-editor-tool - v1.3.0 - 2017-05-19
* https://github.com/OxBRCInformatics/pedigree-editor-tool#readme
* Copyright (c) 2017  Licensed AGPL-3.0 */

String.prototype.parseColor=function(){var a="#";if("rgb("==this.slice(0,4)){var c=this.slice(4,this.length-1).split(","),b=0;do{a+=parseInt(c[b]).toColorPart()}while(++b<3)}else if("#"==this.slice(0,1)){if(4==this.length)for(b=1;b<4;b++)a+=(this.charAt(b)+this.charAt(b)).toLowerCase();7==this.length&&(a=this.toLowerCase())}return 7==a.length?a:arguments[0]||this},Element.collectTextNodes=function(a){return $A($(a).childNodes).collect(function(b){return 3==b.nodeType?b.nodeValue:b.hasChildNodes()?Element.collectTextNodes(b):""}).flatten().join("")},Element.collectTextNodesIgnoreClass=function(a,b){return $A($(a).childNodes).collect(function(c){return 3==c.nodeType?c.nodeValue:c.hasChildNodes()&&!Element.hasClassName(c,b)?Element.collectTextNodesIgnoreClass(c,b):""}).flatten().join("")},Element.setContentZoom=function(a,b){return(a=$(a)).setStyle({fontSize:b/100+"em"}),Prototype.Browser.WebKit&&window.scrollBy(0,0),a},Element.getInlineOpacity=function(a){return $(a).style.opacity||""},Element.forceRerendering=function(a){try{a=$(a);var c=document.createTextNode(" ");a.appendChild(c),a.removeChild(c)}catch(b){}};var Effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},Transitions:{linear:Prototype.K,sinoidal:function(a){return-Math.cos(a*Math.PI)/2+.5},reverse:function(a){return 1-a},flicker:function(a){return(a=-Math.cos(a*Math.PI)/4+.75+Math.random()/4)>1?1:a},wobble:function(a){return-Math.cos(a*Math.PI*(9*a))/2+.5},pulse:function(b,a){return-Math.cos(b*((a||5)-.5)*2*Math.PI)/2+.5},spring:function(a){return 1-Math.cos(4.5*a*Math.PI)*Math.exp(6*-a)},none:function(a){return 0},full:function(a){return 1}},DefaultOptions:{duration:1,fps:100,sync:!1,from:0,to:1,delay:0,queue:"parallel"},tagifyText:function(a){var b="position:relative";Prototype.Browser.IE&&(b+=";zoom:1"),a=$(a),$A(a.childNodes).each(function(c){3==c.nodeType&&(c.nodeValue.toArray().each(function(d){a.insertBefore(new Element("span",{style:b}).update(" "==d?String.fromCharCode(160):d),c)}),Element.remove(c))})},multiple:function(b,c){var e;e=("object"==typeof b||Object.isFunction(b))&&b.length?b:$(b).childNodes;var a=Object.extend({speed:.1,delay:0},arguments[2]||{}),d=a.delay;$A(e).each(function(g,f){new c(g,Object.extend(a,{delay:f*a.speed+d}))})},PAIRS:{slide:["SlideDown","SlideUp"],blind:["BlindDown","BlindUp"],appear:["Appear","Fade"]},toggle:function(b,c,a){return b=$(b),c=(c||"appear").toLowerCase(),Effect[Effect.PAIRS[c][b.visible()?1:0]](b,Object.extend({queue:{position:"end",scope:b.id||"global",limit:1}},a||{}))}};Effect.DefaultOptions.transition=Effect.Transitions.sinoidal,Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[],this.interval=null},_each:function(a){this.effects._each(a)},add:function(b){var c=(new Date).getTime();switch(Object.isString(b.options.queue)?b.options.queue:b.options.queue.position){case"front":this.effects.findAll(function(d){return"idle"==d.state}).each(function(d){d.startOn+=b.finishOn,d.finishOn+=b.finishOn});break;case"with-last":c=this.effects.pluck("startOn").max()||c;break;case"end":c=this.effects.pluck("finishOn").max()||c}b.startOn+=c,b.finishOn+=c,(!b.options.queue.limit||this.effects.length<b.options.queue.limit)&&this.effects.push(b),this.interval||(this.interval=setInterval(this.loop.bind(this),15))},remove:function(a){this.effects=this.effects.reject(function(b){return b==a}),0==this.effects.length&&(clearInterval(this.interval),this.interval=null)},loop:function(){for(var c=(new Date).getTime(),b=0,a=this.effects.length;b<a;b++)this.effects[b]&&this.effects[b].loop(c)}}),Effect.Queues={instances:$H(),get:function(a){return Object.isString(a)?this.instances.get(a)||this.instances.set(a,new Effect.ScopedQueue):a}},Effect.Queue=Effect.Queues.get("global"),Effect.Base=Class.create({position:null,start:function(a){a&&!1===a.transition&&(a.transition=Effect.Transitions.linear),this.options=Object.extend(Object.extend({},Effect.DefaultOptions),a||{}),this.currentFrame=0,this.state="idle",this.startOn=1e3*this.options.delay,this.finishOn=this.startOn+1e3*this.options.duration,this.fromToDelta=this.options.to-this.options.from,this.totalTime=this.finishOn-this.startOn,this.totalFrames=this.options.fps*this.options.duration,this.render=function(){function b(d,c){d.options[c+"Internal"]&&d.options[c+"Internal"](d),d.options[c]&&d.options[c](d)}return function(c){"idle"===this.state&&(this.state="running",b(this,"beforeSetup"),this.setup&&this.setup(),b(this,"afterSetup")),"running"===this.state&&(c=this.options.transition(c)*this.fromToDelta+this.options.from,this.position=c,b(this,"beforeUpdate"),this.update&&this.update(c),b(this,"afterUpdate"))}}(),this.event("beforeStart"),this.options.sync||Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).add(this)},loop:function(c){if(c>=this.startOn){if(c>=this.finishOn)return this.render(1),this.cancel(),this.event("beforeFinish"),this.finish&&this.finish(),void this.event("afterFinish");var b=(c-this.startOn)/this.totalTime,a=(b*this.totalFrames).round();a>this.currentFrame&&(this.render(b),this.currentFrame=a)}},cancel:function(){this.options.sync||Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).remove(this),this.state="finished"},event:function(a){this.options[a+"Internal"]&&this.options[a+"Internal"](this),this.options[a]&&this.options[a](this)},inspect:function(){var a=$H();for(property in this)Object.isFunction(this[property])||a.set(property,this[property]);return"#<Effect:"+a.inspect()+",options:"+$H(this.options).inspect()+">"}}),Effect.Parallel=Class.create(Effect.Base,{initialize:function(a){this.effects=a||[],this.start(arguments[1])},update:function(a){this.effects.invoke("render",a)},finish:function(a){this.effects.each(function(b){b.render(1),b.cancel(),b.event("beforeFinish"),b.finish&&b.finish(a),b.event("afterFinish")})}}),Effect.Tween=Class.create(Effect.Base,{initialize:function(c,f,e){c=Object.isString(c)?$(c):c;var b=$A(arguments),d=b.last(),a=5==b.length?b[3]:null;this.method=Object.isFunction(d)?d.bind(c):Object.isFunction(c[d])?c[d].bind(c):function(g){c[d]=g},this.start(Object.extend({from:f,to:e},a||{}))},update:function(a){this.method(a)}}),Effect.Event=Class.create(Effect.Base,{initialize:function(){this.start(Object.extend({duration:0},arguments[0]||{}))},update:Prototype.emptyFunction}),Effect.Opacity=Class.create(Effect.Base,{initialize:function(b){if(this.element=$(b),!this.element)throw Effect._elementDoesNotExistError;Prototype.Browser.IE&&!this.element.currentStyle.hasLayout&&this.element.setStyle({zoom:1});var a=Object.extend({from:this.element.getOpacity()||0,to:1},arguments[1]||{});a.from=parseFloat(a.from),a.to=parseFloat(a.to),this.start(a)},update:function(a){this.element.setOpacity(a)}}),Effect.Move=Class.create(Effect.Base,{initialize:function(b){if(this.element=$(b),!this.element)throw Effect._elementDoesNotExistError;var a=Object.extend({x:0,y:0,mode:"relative"},arguments[1]||{});this.start(a)},setup:function(){this.element.makePositioned(),this.originalLeft=parseFloat(this.element.getStyle("left")||"0"),this.originalTop=parseFloat(this.element.getStyle("top")||"0"),"absolute"==this.options.mode&&(this.options.x=this.options.x-this.originalLeft,this.options.y=this.options.y-this.originalTop)},update:function(a){this.element.setStyle({left:(this.options.x*a+this.originalLeft).round()+"px",top:(this.options.y*a+this.originalTop).round()+"px"})}}),Effect.MoveBy=function(b,a,c){return new Effect.Move(b,Object.extend({x:c,y:a},arguments[3]||{}))},Effect.Scale=Class.create(Effect.Base,{initialize:function(b,c){if(this.element=$(b),!this.element)throw Effect._elementDoesNotExistError;var a=Object.extend({scaleX:!0,scaleY:!0,scaleContent:!0,scaleFromCenter:!1,scaleMode:"box",scaleFrom:100,scaleTo:c},arguments[2]||{});this.start(a)},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||!1,this.elementPositioning=this.element.getStyle("position"),this.originalStyle={},["top","left","width","height","fontSize"].each(function(b){this.originalStyle[b]=this.element.style[b]}.bind(this)),this.originalTop=this.element.offsetTop,this.originalLeft=this.element.offsetLeft;var a=this.element.getStyle("font-size")||"100%";["em","px","%","pt"].each(function(b){a.indexOf(b)>0&&(this.fontSize=parseFloat(a),this.fontSizeType=b)}.bind(this)),this.factor=(this.options.scaleTo-this.options.scaleFrom)/100,this.dims=null,"box"==this.options.scaleMode&&(this.dims=[this.element.offsetHeight,this.element.offsetWidth]),/^content/.test(this.options.scaleMode)&&(this.dims=[this.element.scrollHeight,this.element.scrollWidth]),this.dims||(this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth])},update:function(a){var b=this.options.scaleFrom/100+this.factor*a;this.options.scaleContent&&this.fontSize&&this.element.setStyle({fontSize:this.fontSize*b+this.fontSizeType}),this.setDimensions(this.dims[0]*b,this.dims[1]*b)},finish:function(a){this.restoreAfterFinish&&this.element.setStyle(this.originalStyle)},setDimensions:function(a,e){var f={};if(this.options.scaleX&&(f.width=e.round()+"px"),this.options.scaleY&&(f.height=a.round()+"px"),this.options.scaleFromCenter){var c=(a-this.dims[0])/2,b=(e-this.dims[1])/2;"absolute"==this.elementPositioning?(this.options.scaleY&&(f.top=this.originalTop-c+"px"),this.options.scaleX&&(f.left=this.originalLeft-b+"px")):(this.options.scaleY&&(f.top=-c+"px"),this.options.scaleX&&(f.left=-b+"px"))}this.element.setStyle(f)}}),Effect.Highlight=Class.create(Effect.Base,{initialize:function(b){if(this.element=$(b),!this.element)throw Effect._elementDoesNotExistError;var a=Object.extend({startcolor:"#ffff99"},arguments[1]||{});this.start(a)},setup:function(){if("none"==this.element.getStyle("display"))return void this.cancel();this.oldStyle={},this.options.keepBackgroundImage||(this.oldStyle.backgroundImage=this.element.getStyle("background-image"),this.element.setStyle({backgroundImage:"none"})),this.options.endcolor||(this.options.endcolor=this.element.getStyle("background-color").parseColor("#ffffff")),this.options.restorecolor||(this.options.restorecolor=this.element.getStyle("background-color")),this._base=$R(0,2).map(function(a){return parseInt(this.options.startcolor.slice(2*a+1,2*a+3),16)}.bind(this)),this._delta=$R(0,2).map(function(a){return parseInt(this.options.endcolor.slice(2*a+1,2*a+3),16)-this._base[a]}.bind(this))},update:function(a){this.element.setStyle({backgroundColor:$R(0,2).inject("#",function(b,c,d){return b+(this._base[d]+this._delta[d]*a).round().toColorPart()}.bind(this))})},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}))}}),Effect.ScrollTo=function(c){var b=arguments[1]||{},a=document.viewport.getScrollOffsets(),d=$(c).cumulativeOffset();return b.offset&&(d[1]+=b.offset),new Effect.Tween(null,a.top,d[1],b,function(e){scrollTo(a.left,e.round())})},Effect.Fade=function(c){var a=(c=$(c)).getInlineOpacity(),b=Object.extend({from:c.getOpacity()||1,to:0,afterFinishInternal:function(d){0==d.options.to&&d.element.hide().setStyle({opacity:a})}},arguments[1]||{});return new Effect.Opacity(c,b)},Effect.Appear=function(b){b=$(b);var a=Object.extend({from:"none"==b.getStyle("display")?0:b.getOpacity()||0,to:1,afterFinishInternal:function(c){c.element.forceRerendering()},beforeSetup:function(c){c.element.setOpacity(c.options.from).show()}},arguments[1]||{});return new Effect.Opacity(b,a)},Effect.Puff=function(b){var a={opacity:(b=$(b)).getInlineOpacity(),position:b.getStyle("position"),top:b.style.top,left:b.style.left,width:b.style.width,height:b.style.height};return new Effect.Parallel([new Effect.Scale(b,200,{sync:!0,scaleFromCenter:!0,scaleContent:!0,restoreAfterFinish:!0}),new Effect.Opacity(b,{sync:!0,to:0})],Object.extend({duration:1,beforeSetupInternal:function(c){Position.absolutize(c.effects[0].element)},afterFinishInternal:function(c){c.effects[0].element.hide().setStyle(a)}},arguments[1]||{}))},Effect.BlindUp=function(a){return(a=$(a)).makeClipping(),new Effect.Scale(a,0,Object.extend({scaleContent:!1,scaleX:!1,restoreAfterFinish:!0,afterFinishInternal:function(b){b.element.hide().undoClipping()}},arguments[1]||{}))},Effect.BlindDown=function(b){var a=(b=$(b)).getDimensions();return new Effect.Scale(b,100,Object.extend({scaleContent:!1,scaleX:!1,scaleFrom:0,scaleMode:{originalHeight:a.height,originalWidth:a.width},restoreAfterFinish:!0,afterSetup:function(c){c.element.makeClipping().setStyle({height:"0px"}).show()},afterFinishInternal:function(c){c.element.undoClipping()}},arguments[1]||{}))},Effect.SwitchOff=function(b){var a=(b=$(b)).getInlineOpacity();return new Effect.Appear(b,Object.extend({duration:.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(c){new Effect.Scale(c.element,1,{duration:.3,scaleFromCenter:!0,scaleX:!1,scaleContent:!1,restoreAfterFinish:!0,beforeSetup:function(d){d.element.makePositioned().makeClipping()},afterFinishInternal:function(d){d.element.hide().undoClipping().undoPositioned().setStyle({opacity:a})}})}},arguments[1]||{}))},Effect.DropOut=function(b){var a={top:(b=$(b)).getStyle("top"),left:b.getStyle("left"),opacity:b.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(b,{x:0,y:100,sync:!0}),new Effect.Opacity(b,{sync:!0,to:0})],Object.extend({duration:.5,beforeSetup:function(c){c.effects[0].element.makePositioned()},afterFinishInternal:function(c){c.effects[0].element.hide().undoPositioned().setStyle(a)}},arguments[1]||{}))},Effect.Shake=function(d){d=$(d);var b=Object.extend({distance:20,duration:.5},arguments[1]||{}),e=parseFloat(b.distance),c=parseFloat(b.duration)/10,a={top:d.getStyle("top"),left:d.getStyle("left")};return new Effect.Move(d,{x:e,y:0,duration:c,afterFinishInternal:function(f){new Effect.Move(f.element,{x:2*-e,y:0,duration:2*c,afterFinishInternal:function(g){new Effect.Move(g.element,{x:2*e,y:0,duration:2*c,afterFinishInternal:function(h){new Effect.Move(h.element,{x:2*-e,y:0,duration:2*c,afterFinishInternal:function(i){new Effect.Move(i.element,{x:2*e,y:0,duration:2*c,afterFinishInternal:function(j){new Effect.Move(j.element,{x:-e,y:0,duration:c,afterFinishInternal:function(k){k.element.undoPositioned().setStyle(a)}})}})}})}})}})}})},Effect.SlideDown=function(c){var a=(c=$(c).cleanWhitespace()).down().getStyle("bottom"),b=c.getDimensions();return new Effect.Scale(c,100,Object.extend({scaleContent:!1,scaleX:!1,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:b.height,originalWidth:b.width},restoreAfterFinish:!0,afterSetup:function(d){d.element.makePositioned(),d.element.down().makePositioned(),window.opera&&d.element.setStyle({top:""}),d.element.makeClipping().setStyle({height:"0px"}).show()},afterUpdateInternal:function(d){d.element.down().setStyle({bottom:d.dims[0]-d.element.clientHeight+"px"})},afterFinishInternal:function(d){d.element.undoClipping().undoPositioned(),d.element.down().undoPositioned().setStyle({bottom:a})}},arguments[1]||{}))},Effect.SlideUp=function(c){var a=(c=$(c).cleanWhitespace()).down().getStyle("bottom"),b=c.getDimensions();return new Effect.Scale(c,window.opera?0:1,Object.extend({scaleContent:!1,scaleX:!1,scaleMode:"box",scaleFrom:100,scaleMode:{originalHeight:b.height,originalWidth:b.width},restoreAfterFinish:!0,afterSetup:function(d){d.element.makePositioned(),d.element.down().makePositioned(),window.opera&&d.element.setStyle({top:""}),d.element.makeClipping().show()},afterUpdateInternal:function(d){d.element.down().setStyle({bottom:d.dims[0]-d.element.clientHeight+"px"})},afterFinishInternal:function(d){d.element.hide().undoClipping().undoPositioned(),d.element.down().undoPositioned().setStyle({bottom:a})}},arguments[1]||{}))},Effect.Squish=function(a){return new Effect.Scale(a,window.opera?1:0,{restoreAfterFinish:!0,beforeSetup:function(b){b.element.makeClipping()},afterFinishInternal:function(b){b.element.hide().undoClipping()}})},Effect.Grow=function(c){c=$(c);var h,f,e,d,b=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{}),a={top:c.style.top,left:c.style.left,height:c.style.height,width:c.style.width,opacity:c.getInlineOpacity()},g=c.getDimensions();switch(b.direction){case"top-left":h=f=e=d=0;break;case"top-right":h=g.width,f=d=0,e=-g.width;break;case"bottom-left":h=e=0,f=g.height,d=-g.height;break;case"bottom-right":h=g.width,f=g.height,e=-g.width,d=-g.height;break;case"center":h=g.width/2,f=g.height/2,e=-g.width/2,d=-g.height/2}return new Effect.Move(c,{x:h,y:f,duration:.01,beforeSetup:function(i){i.element.hide().makeClipping().makePositioned()},afterFinishInternal:function(i){new Effect.Parallel([new Effect.Opacity(i.element,{sync:!0,to:1,from:0,transition:b.opacityTransition}),new Effect.Move(i.element,{x:e,y:d,sync:!0,transition:b.moveTransition}),new Effect.Scale(i.element,100,{scaleMode:{originalHeight:g.height,originalWidth:g.width},sync:!0,scaleFrom:window.opera?1:0,transition:b.scaleTransition,restoreAfterFinish:!0})],Object.extend({beforeSetup:function(j){j.effects[0].element.setStyle({height:"0px"}).show()},afterFinishInternal:function(j){j.effects[0].element.undoClipping().undoPositioned().setStyle(a)}},b))}})},Effect.Shrink=function(c){c=$(c);var e,d,b=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{}),a={top:c.style.top,left:c.style.left,height:c.style.height,width:c.style.width,opacity:c.getInlineOpacity()},f=c.getDimensions();switch(b.direction){case"top-left":e=d=0;break;case"top-right":e=f.width,d=0;break;case"bottom-left":e=0,d=f.height;break;case"bottom-right":e=f.width,d=f.height;break;case"center":e=f.width/2,d=f.height/2}return new Effect.Parallel([new Effect.Opacity(c,{sync:!0,to:0,from:1,transition:b.opacityTransition}),new Effect.Scale(c,window.opera?1:0,{sync:!0,transition:b.scaleTransition,restoreAfterFinish:!0}),new Effect.Move(c,{x:e,y:d,sync:!0,transition:b.moveTransition})],Object.extend({beforeStartInternal:function(g){g.effects[0].element.makePositioned().makeClipping()},afterFinishInternal:function(g){g.effects[0].element.hide().undoClipping().undoPositioned().setStyle(a)}},b))},Effect.Pulsate=function(c){c=$(c);var b=arguments[1]||{},a=c.getInlineOpacity(),e=b.transition||Effect.Transitions.linear,d=function(f){return 1-e(-Math.cos(f*(b.pulses||5)*2*Math.PI)/2+.5)};return new Effect.Opacity(c,Object.extend(Object.extend({duration:2,from:0,afterFinishInternal:function(f){f.element.setStyle({opacity:a})}},b),{transition:d}))},Effect.Fold=function(b){var a={top:(b=$(b)).style.top,left:b.style.left,width:b.style.width,height:b.style.height};return b.makeClipping(),new Effect.Scale(b,5,Object.extend({scaleContent:!1,scaleX:!1,afterFinishInternal:function(c){new Effect.Scale(b,1,{scaleContent:!1,scaleY:!1,afterFinishInternal:function(d){d.element.hide().undoClipping().setStyle(a)}})}},arguments[1]||{}))},Effect.Morph=Class.create(Effect.Base,{initialize:function(c){if(this.element=$(c),!this.element)throw Effect._elementDoesNotExistError;var a=Object.extend({style:{}},arguments[1]||{});if(Object.isString(a.style))if(a.style.include(":"))this.style=a.style.parseStyle();else{this.element.addClassName(a.style),this.style=$H(this.element.getStyles()),this.element.removeClassName(a.style);var b=this.element.getStyles();this.style=this.style.reject(function(d){return d.value==b[d.key]}),a.afterFinishInternal=function(d){d.element.addClassName(d.options.style),d.transforms.each(function(e){d.element.style[e.style]=""})}}else this.style=$H(a.style);this.start(a)},setup:function(){function a(b){return b&&!["rgba(0, 0, 0, 0)","transparent"].include(b)||(b="#ffffff"),b=b.parseColor(),$R(0,2).map(function(c){return parseInt(b.slice(2*c+1,2*c+3),16)})}this.transforms=this.style.map(function(g){var f=g[0],e=g[1],d=null;if("#zzzzzz"!=e.parseColor("#zzzzzz"))e=e.parseColor(),d="color";else if("opacity"==f)e=parseFloat(e),Prototype.Browser.IE&&!this.element.currentStyle.hasLayout&&this.element.setStyle({zoom:1});else if(Element.CSS_LENGTH.test(e)){var c=e.match(/^([\+\-]?[0-9\.]+)(.*)$/);e=parseFloat(c[1]),d=3==c.length?c[2]:null}var b=this.element.getStyle(f);return{style:f.camelize(),originalValue:"color"==d?a(b):parseFloat(b||0),targetValue:"color"==d?a(e):e,unit:d}}.bind(this)).reject(function(b){return b.originalValue==b.targetValue||"color"!=b.unit&&(isNaN(b.originalValue)||isNaN(b.targetValue))})},update:function(a){for(var b,d={},c=this.transforms.length;c--;)d[(b=this.transforms[c]).style]="color"==b.unit?"#"+Math.round(b.originalValue[0]+(b.targetValue[0]-b.originalValue[0])*a).toColorPart()+Math.round(b.originalValue[1]+(b.targetValue[1]-b.originalValue[1])*a).toColorPart()+Math.round(b.originalValue[2]+(b.targetValue[2]-b.originalValue[2])*a).toColorPart():(b.originalValue+(b.targetValue-b.originalValue)*a).toFixed(3)+(null===b.unit?"":b.unit);this.element.setStyle(d,!0)}}),Effect.Transform=Class.create({initialize:function(a){this.tracks=[],this.options=arguments[1]||{},this.addTracks(a)},addTracks:function(a){return a.each(function(b){var c=(b=$H(b)).values().first();this.tracks.push($H({ids:b.keys().first(),effect:Effect.Morph,options:{style:c}}))}.bind(this)),this},play:function(){return new Effect.Parallel(this.tracks.map(function(a){var d=a.get("ids"),c=a.get("effect"),b=a.get("options");return[$(d)||$$(d)].flatten().map(function(f){return new c(f,Object.extend({sync:!0},b))})}).flatten(),this.options)}}),Element.CSS_PROPERTIES=$w("backgroundColor backgroundPosition borderBottomColor borderBottomStyle borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth borderRightColor borderRightStyle borderRightWidth borderSpacing borderTopColor borderTopStyle borderTopWidth bottom clip color fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop markerOffset maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex"),Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/,String.__parseStyleElement=document.createElement("div"),String.prototype.parseStyle=function(){var b,a=$H();return Prototype.Browser.WebKit?b=new Element("div",{style:this}).style:(String.__parseStyleElement.innerHTML='<div style="'+this+'"></div>',b=String.__parseStyleElement.childNodes[0].style),Element.CSS_PROPERTIES.each(function(c){b[c]&&a.set(c,b[c])}),Prototype.Browser.IE&&this.include("opacity")&&a.set("opacity",this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1]),a},document.defaultView&&document.defaultView.getComputedStyle?Element.getStyles=function(b){var a=document.defaultView.getComputedStyle($(b),null);return Element.CSS_PROPERTIES.inject({},function(c,d){return c[d]=a[d],c})}:Element.getStyles=function(b){var c,a=(b=$(b)).currentStyle;return(c=Element.CSS_PROPERTIES.inject({},function(d,e){return d[e]=a[e],d})).opacity||(c.opacity=b.getOpacity()),c},Effect.Methods={morph:function(a,b){return a=$(a),new Effect.Morph(a,Object.extend({style:b},arguments[2]||{})),a},visualEffect:function(c,e,b){c=$(c);var d=e.dasherize().camelize(),a=d.charAt(0).toUpperCase()+d.substring(1);return new Effect[a](c,b),c},highlight:function(b,a){return b=$(b),new Effect.Highlight(b,a),b}},$w("fade appear grow shrink fold blindUp blindDown slideUp slideDown pulsate shake puff squish switchOff dropOut").each(function(a){Effect.Methods[a]=function(c,b){return c=$(c),Effect[a.charAt(0).toUpperCase()+a.substring(1)](c,b),c}}),$w("getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles").each(function(a){Effect.Methods[a]=Element[a]}),Element.addMethods(Effect.Methods);