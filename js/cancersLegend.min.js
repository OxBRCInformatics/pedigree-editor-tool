/*! pedigree-editor-tool - v1.3.0-SNAPSHOT - 2017-05-19
* https://github.com/OxBRCInformatics/pedigree-editor-tool#readme
* Copyright (c) 2017  Licensed AGPL-3.0 */

var CancerLegend=Class.create(Legend,{initialize:function($super){this._cancerColors={Breast:"#e267a3",Ovarian:"#9370DB",Colon:"#945d34",Uterus:"#c93320",Prostate:"#ecb739",Pancreatic:"#4657dc",Melanoma:"#444444",Kidney:"#197419",Gastric:"#9aac8c",Lung:"#008080",Brain:"#F5DEB3",Oesophagus:"#BC8F8F",Thyroid:"#FFFF00"},this._cancerLabels={Breast:"Breast cancer",Ovarian:"Ovarian cancer",Colon:"Colon cancer",Uterus:"Uterus cancer",Prostate:"Prostate cancer",Pancreatic:"Pancreatic cancer",Melanoma:"Melanoma",Kidney:"Kidney cancer",Gastric:"Gastric cancer",Lung:"Lung cancer",Brain:"Brain cancer",Oesophagus:"Oesophagus cancer",Thyroid:"Thyroid cancer"},$super("Cancers",!0)},_getPrefix:function(id){return"cancers"},_getAllSupportedCancers:function(){var clist=[];for(var cancer in this._cancerColors)this._cancerColors.hasOwnProperty(cancer)&&clist.push(cancer);return clist},addCase:function($super,id,name,nodeID){$super(id,name=this._cancerLabels.hasOwnProperty(name)?this._cancerLabels[name]:name,nodeID)},_generateElement:function($super,cancerID,name){if(!this._objectColors.hasOwnProperty(cancerID)){var color=this._generateColor(cancerID);this._objectColors[cancerID]=color,document.fire("cancer:color",{id:cancerID,color:color})}return $super(cancerID,name)},_onDropObject:function(node,cancerID){if(!node.isPersonGroup()){var currentCancers=Helpers.cloneObject(node.getCancers());if(currentCancers.hasOwnProperty(cancerID)&&currentCancers[cancerID].affected)this._onFailedDrag(node,"This person is already marked as affected by the selected cancer","Can't drag this cancer to this person");else{currentCancers[cancerID]={affected:!0},editor.getView().unmarkAll();var properties={setCancers:currentCancers},event={nodeID:node.getID(),properties:properties};document.fire("pedigree:node:setproperty",event)}}},_generateColor:function(cancerID){if(this._objectColors.hasOwnProperty(cancerID))return this._objectColors[cancerID];if(this._cancerColors.hasOwnProperty(cancerID))return this._cancerColors[cancerID];var usedColors=Object.values(this._objectColors),prefColors=["#f8ebb7","#eac080","#bf6632","#a47841","#c95555","#ae6c57"];if(usedColors.each(function(color){prefColors=prefColors.without(color)}),prefColors.length>0)return prefColors[0];for(var randomColor=Raphael.getColor();"#ffffff"==randomColor||-1!=usedColors.indexOf(randomColor);)randomColor="#"+((1<<24)*Math.random()|0).toString(16);return randomColor}});