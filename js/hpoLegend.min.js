/*! pedigree-editor-tool - v1.3.1 - 2017-05-22
* https://github.com/OxBRCInformatics/pedigree-editor-tool#readme
* Copyright (c) 2017  Licensed AGPL-3.0 */

var HPOLegend=Class.create(Legend,{initialize:function($super){$super("Phenotypes",!0),this._termCache={}},_getPrefix:function(id){return"phenotype"},getTerm:function(hpoID){if(!this._termCache.hasOwnProperty(hpoID)){var whenNameIsLoaded=function(){this._updateTermName(hpoID)};this._termCache[hpoID]=new HPOTerm(hpoID,null,null,null,whenNameIsLoaded.bind(this))}return this._termCache[hpoID]},getObjectColor:function(id){return"#CCCCCC"},addCase:function($super,id,name,valueAll,nodeID){this._termCache.hasOwnProperty(id)||(this._termCache[id]=new HPOTerm(id,name,valueAll.hpoPresent,valueAll)),$super(id,name,valueAll,nodeID)},_updateTermName:function(id){var _this=this;this._legendBox.down("li#"+this._getPrefix()+"-"+_this._hashID(id)+" .disorder-name").update(this.getTerm(id).getName())},_onDropObject:function(node,hpoID){if(!node.isPersonGroup()){var currentHPO=node.getHPO().slice(0);if(-1==currentHPO.indexOf(hpoID)){currentHPO.push(hpoID),editor.getView().unmarkAll();var properties={setHPO:currentHPO},event={nodeID:node.getID(),properties:properties};document.fire("pedigree:node:setproperty",event)}else this._onFailedDrag(node,"This person already has the selected phenotype","Can't drag this phenotype to this person")}},_generateElement:function($super,disorderID,name,valueAll){return $super(disorderID,name,valueAll)}});