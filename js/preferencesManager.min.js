/*! pedigree-editor-tool - v1.3.1 - 2017-05-22
* https://github.com/OxBRCInformatics/pedigree-editor-tool#readme
* Copyright (c) 2017  Licensed AGPL-3.0 */

var PreferencesManager=Class.create({initialize:function(templatePreferences){this.preferences=templatePreferences},load:function(callWhenReady){var preferencesJsonURL=new XWiki.Document("PedigreeInterface","PhenoTips").getURL("get","action=getPreferences");preferencesJsonURL+="&rand="+Math.random();var defaultResponse={};defaultResponse.responseJSON={user:{firstName:"",lastName:"",hideDraggingHint:!1},global:{disabledFields:[],dateDisplayFormat:"MDY",dateEditFormat:"YMD",nonStandardAdoptedOutGraphic:!1,propagateFatherLastName:!0,lineStyle:"regular"}},this.onPreferencesAvailable(defaultResponse),callWhenReady()},onPreferencesAvailable:function(response){response.responseJSON?(Helpers.setByTemplate(this.preferences,response.responseJSON),console.log("Loaded preferences: "+stringifyObject(response.responseJSON))):console.log("Failed to loaded properties, no JSON")},getConfigurationOption:function(optionName){return this.preferences.pedigree.hasOwnProperty(optionName)?this.preferences.pedigree[optionName]:this.preferences.user.hasOwnProperty(optionName)?this.preferences.user[optionName]:this.preferences.global.hasOwnProperty(optionName)?this.preferences.global[optionName]:null},setConfigurationOption:function(domain,optionName,value){if("user"==domain)this.preferences.user[optionName]=value;else{if("pedigree"!=domain)throw"Unsupported options domain: "+domain;this.preferences.pedigree[optionName]=value}}});